#!/usr/bin/env node

'use strict';

var lintPaths = require('../lib/lint-paths')
  , report    = require('../lib/console-report')

  , opts = require('optimist')
	.usage("Usage: $0 <options> <paths>...", {
		cache: {
			boolean: true,
			description: "Cache generated reports (for faster retieval later)"
		},
		color: {
			boolean: true,
			default: true,
			description: "Colorize output"
		},
		help: {
			boolean: true,
			desription: "Show this help"
		},
		maxerrfiles: {
			default: 5,
			description: "Maximum number of files for "
				+ "which warnings are reported"
		},
		progress: {
			boolean: true,
			default: true,
			description: "Whether to generate reports on the go"
		},
		depth: {
			default: Infinity,
			description: "How deeply to recurse into directories (default: Infinity)"
		},
		ignoreRules: {
			default: 'git',
			description: "Obey ignore rules up to given mode"
		},
		watch: {
			boolean: true,
			description: "Live console mode, updated on file and settings changes"
		}
	})
  , argv = opts.argv
  , paths = argv._;

if (argv.help) {
	console.log(opts.help());
	process.exit(0);
}

delete argv._;
delete argv.$0;

if (!paths.length) {
	paths.push('.');
}

if (argv.watch) {
	setTimeout(function () { }, 1e9);
}

report(lintPaths(paths, argv), argv).end();
